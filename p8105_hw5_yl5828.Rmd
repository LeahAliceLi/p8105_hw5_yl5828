---
title: "p8105_hw5_yl5828"
author: "Leah Li"
date: '`r format(Sys.time(), "%Y-%m-%d")`'
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(patchwork)
library(rvest)

library(p8105.datasets)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```



### Problem 1

#### Create the required function to check if there are any duplicate birthdays.

```{r create function for checking duplicate}
birthday_sim <- function(n_people) {
  birthdays <- sample(1:365, size = n_people, replace = TRUE)
  any(duplicated(birthdays))
}
```

#### Repeat the function 10000 times and compute and probablity that at least two people in the group will share a birthday.

```{r repeat and find average probablity}
set.seed(1)

sim_results <- 
  tibble(group_size = 2:50) %>% 
  mutate(
    sim_outcomes = map(group_size, ~ replicate(10000, birthday_sim(.x))),
    prob_shared  = map_dbl(sim_outcomes, mean)
  )
```

#### Creae a plot to show the results.
```{r plot graph}
ggplot(sim_results, aes(x = group_size, y = prob_shared)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(
    x = "Group size (n)",
    y = "Probability of â‰¥ 1 shared birthday",
    title = "Q1: Simulated Probability of Shared Birthdays"
  ) +
  theme_minimal()
```

#### Comment on the plot:
The curve shows an exponential-like growth, rapidly increasing from near-zero probability with small groups to near-certainty with larger groups.
The simulation shows that with just 23 people, there's approximately a 50% chance that two people share a birthday. With 30 people, the probability rises to about 70%. With 40 people, the probability exceeds 90%. With 50 people, the probability is nearly 97%.


### Problem 2

```{r}

```


















